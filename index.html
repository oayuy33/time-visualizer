<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>时间看板 - 自定义主题版</title>
    <style>
        /* 这里定义了默认颜色，我们会通过 JS 修改这些值 */
        :root {
            --bg-color: #020617;
            --card-bg: rgba(30, 41, 59, 0.7);
            --dot-empty: #1e293b;
            --dot-fill: #38bdf8;
            --text-main: #f8fafc;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 40px 20px;
            transition: background-color 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 600px;
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
        }

        /* 自定义菜单样式 */
        .settings-menu {
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        input[type="color"] {
            border: none;
            width: 24px;
            height: 24px;
            cursor: pointer;
            background: none;
        }

        #motto {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: var(--dot-fill);
            font-style: italic;
            cursor: pointer;
        }

        .section { margin-bottom: 25px; }
        .header { display: flex; justify-content: space-between; font-size: 0.85rem; color: #94a3b8; margin-bottom: 8px; }
        .dots-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(10px, 1fr)); gap: 5px; }
        .dot { aspect-ratio: 1; border-radius: 50%; background: var(--dot-empty); transition: transform 0.2s; }
        .dot.active { background: var(--dot-fill); box-shadow: 0 0 8px var(--dot-fill); }
        .dot:hover { transform: scale(1.5); background: #fff !important; }

        h1 { font-size: 1.5rem; font-weight: 300; margin-bottom: 10px; opacity: 0.8; }
    </style>
</head>
<body>

    <div class="settings-menu">
        <div class="setting-item">
            <label>背景色</label>
            <input type="color" id="bg-picker" value="#020617">
        </div>
        <div class="setting-item">
            <label>点阵色</label>
            <input type="color" id="dot-picker" value="#38bdf8">
        </div>
    </div>

    <div class="container">
        <div id="motto">点击这里输入你的座右铭...</div>
        <div id="sections"></div>
    </div>

<script>
    // --- 1. 初始化数据 ---
    const root = document.querySelector(':root');
    const bgPicker = document.getElementById('bg-picker');
    const dotPicker = document.getElementById('dot-picker');
    const mottoDisplay = document.getElementById('motto');

    // 从本地读取保存的颜色和座右铭
    const savedBg = localStorage.getItem('cfg-bg') || '#020617';
    const savedDot = localStorage.getItem('cfg-dot') || '#38bdf8';
    const savedMotto = localStorage.getItem('userMotto') || '生活不在于呼吸的次数，而在于那些令你屏息的时刻。';

    // 应用初始值
    updateTheme('--bg-color', savedBg);
    updateTheme('--dot-fill', savedDot);
    bgPicker.value = savedBg;
    dotPicker.value = savedDot;
    mottoDisplay.innerText = savedMotto;

    // --- 2. 监听颜色变化 ---
    bgPicker.addEventListener('input', (e) => {
        updateTheme('--bg-color', e.target.value);
        localStorage.setItem('cfg-bg', e.target.value);
    });

    dotPicker.addEventListener('input', (e) => {
        updateTheme('--dot-fill', e.target.value);
        localStorage.setItem('cfg-dot', e.target.value);
    });

    function updateTheme(variable, value) {
        root.style.setProperty(variable, value);
    }

    // --- 3. 座右铭点击修改 ---
    mottoDisplay.onclick = function() {
        const newMotto = prompt("输入新的座右铭：", mottoDisplay.innerText);
        if (newMotto) {
            mottoDisplay.innerText = newMotto;
            localStorage.setItem('userMotto', newMotto);
        }
    };

    // --- 4. 核心逻辑：年/月/日/时 可视化 ---
    function render() {
        const now = new Date();
        const target = document.getElementById('sections');
        target.innerHTML = '';

        // 年
        const startYear = new Date(now.getFullYear(), 0, 1);
        const endYear = new Date(now.getFullYear() + 1, 0, 1);
        const totalYear = Math.ceil((endYear - startYear)/(24*3600*1000));
        const passYear = Math.floor((now - startYear)/(24*3600*1000));
        createGrid("今年已流逝 (天)", totalYear, passYear);

        // 月
        const totalMonth = new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
        const passMonth = now.getDate();
        createGrid("本月已流逝 (天)", totalMonth, passMonth);

        // 日
        createGrid("今日已流逝 (小时)", 24, now.getHours());

        // 时
        createGrid("当前小时流逝 (分钟)", 60, now.getMinutes());
    }

    function createGrid(title, total, passed) {
        const percent = ((passed/total)*100).toFixed(1);
        const html = `
            <div class="section">
                <div class="header"><span>${title}</span><span>${percent}%</span></div>
                <div class="dots-grid">${Array(total).fill(0).map((_, i) => `<div class="dot ${i<passed?'active':''}"></div>`).join('')}</div>
            </div>`;
        document.getElementById('sections').innerHTML += html;
    }

    render();
    setInterval(render, 60000); // 每分钟刷新一次
</script>

</body>
</html>

